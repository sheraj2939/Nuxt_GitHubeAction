import{createRequire}from"module";const require=createRequire(import.meta.url);
import{fileURLToPath as Hr}from"url";import{Buffer as Pr}from"node:buffer";import Lr from"node:process";import{pipeline as Ar,Readable as Tr}from"node:stream";import{promisify as Nr}from"node:util";import{Buffer as Ot}from"node:buffer";var ve=(e,t,r)=>{if(!t.has(e))throw TypeError("Cannot "+r)},x=(e,t,r)=>(ve(e,t,"read from private field"),r?r.call(e):t.get(e)),N=(e,t,r)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,r)},$=(e,t,r,n)=>(ve(e,t,"write to private field"),n?n.call(e,r):t.set(e,r),r),Q=(e=>(e.Delete="delete",e.Read="read",e.Write="write",e))(Q||{}),bt={invalid_vary:"Responses must not use unsupported directives of the `Netlify-Vary` header (https://ntl.fyi/cache_api_invalid_vary).",no_cache:"Responses must not set cache control headers with the `private`, `no-cache` or `no-store` directives (https://ntl.fyi/cache_api_no_cache).",low_ttl:"Responses must have a cache control header with a `max-age` or `s-maxage` directive (https://ntl.fyi/cache_api_low_ttl).",no_directive:"Responses must have a cache control header with caching directives (https://ntl.fyi/cache_api_no_directive).",no_ttl:"Responses must have a cache control header with a `max-age` or `s-maxage` directive (https://ntl.fyi/cache_api_no_ttl).",no_status:"Responses must specify a status code (https://ntl.fyi/cache_api_no_status).",invalid_directive:"Responses must have a cache control header with caching directives (https://ntl.fyi/cache_api_invalid_directive).",status:"Responses must have a status code between 200 and 299 (https://ntl.fyi/cache_api_status)."},kt="The server has returned an unexpected error (https://ntl.fyi/cache_api_error).",It="netlify-programmable-error",_t="netlify-programmable-headers",Et="netlify-programmable-status",Pt="netlify-programmable-store",Lt="netlify-forwarded-host",At="user-agent",Re=new Set(["http:","https:"]),Tt=new Set(["cookie","content-encoding","content-length"]),J=Symbol("getInternalHeaders"),Ce=Symbol("serializeResourceHeaders"),Y,T,K,M,Nt=class{constructor({base64Encode:e,getContext:t,name:r,userAgent:n}){N(this,Y,void 0),N(this,T,void 0),N(this,K,void 0),N(this,M,void 0),$(this,Y,e),$(this,T,t),$(this,K,r),$(this,M,n)}[J](e){let{host:t,token:r}=e,n={Authorization:`Bearer ${r}`,[Pt]:x(this,K)};return t&&(n[Lt]=t),x(this,M)&&(n[At]=x(this,M)),n}[Ce](e){let t={};return e.forEach((r,n)=>{Tt.has(n)||(n==="set-cookie"?(t[n]=t[n]||[],t[n].push(r)):t[n]=r.split(","))}),x(this,Y).call(this,JSON.stringify(t))}async add(e){await this.put(new Request(e),await fetch(e))}async addAll(e){await Promise.allSettled(e.map(t=>this.add(t)))}async delete(e){let t=x(this,T).call(this,{operation:"delete"});if(t){let r=ue(e);await fetch(`${t.url}/${le(r)}`,{headers:this[J](t),method:"DELETE"})}return!0}async keys(e){return[]}async match(e){try{let t=x(this,T).call(this,{operation:"read"});if(!t)return;let r=ue(e),n=`${t.url}/${le(r)}`,o=await fetch(n,{headers:this[J](t),method:"GET"});return o.ok?o:void 0}catch{}}async matchAll(e,t){if(!e)return[];let r=await this.match(e);return r?[r]:[]}async put(e,t){var a,i;if(!t.ok)throw new TypeError(`Cannot cache response with status ${t.status}.`);if(e instanceof Request&&e.method!=="GET")throw new TypeError(`Cannot cache response to ${e.method} request.`);if(t.status===206)throw new TypeError("Cannot cache response to a range request (206 Partial Content).");if((a=t.headers.get("vary"))!=null&&a.includes("*"))throw new TypeError("Cannot cache response with 'Vary: *' header.");let r=x(this,T).call(this,{operation:"write"});if(!r)return;let n=ue(e),o=await fetch(`${r.url}/${le(n)}`,{body:t.body,headers:{...this[J](r),[_t]:this[Ce](t.headers),[Et]:t.status.toString()},duplex:"half",method:"POST"});if(!o.ok){let s=o.headers.get(It)??"",h=bt[s]||kt;(i=r.logger)==null||i.call(r,`Failed to write to the cache: ${h}`)}}};Y=new WeakMap;T=new WeakMap;K=new WeakMap;M=new WeakMap;var ue=e=>{let t;if(e instanceof Request)t=new URL(e.url);else try{t=new URL(String(e))}catch{throw new TypeError(`${e} is not a valid URL.`)}if(!Re.has(t.protocol))throw new TypeError(`Cannot cache response for URL with unsupported protocol (${t.protocol}). Supported protocols are ${[...Re].join(", ")}.`);return t},le=e=>encodeURIComponent(e.toString()),X,C,be=class{constructor(e){N(this,X,void 0),N(this,C,void 0),$(this,X,e),$(this,C,new Map)}open(e){let t=x(this,C).get(e);return t||(t=new Nt({...x(this,X),name:e}),x(this,C).set(e,t)),Promise.resolve(t)}has(e){return Promise.resolve(x(this,C).has(e))}delete(e){return Promise.resolve(x(this,C).delete(e))}keys(){return Promise.resolve([...x(this,C).keys()])}async match(e,t){var r;if(t!=null&&t.cacheName)return(r=x(this,C).get(t.cacheName))==null?void 0:r.match(e);for(let n of x(this,C).values())if(await n.match(e)===void 0)return}};X=new WeakMap;C=new WeakMap;var U=class e extends Error{constructor(t){super(t),this.name="NetlifyUserError",Object.setPrototypeOf(this,e.prototype)}};var $t={"cache-api-read":100,"cache-api-write":20},Z=class{constructor(t=$t){this.counts=new Map,this.limits=t}register(t){let r=this.counts.get(t)||0,n=this.limits[t]||0;return r>=n?!1:(this.counts.set(t,r+1),!0)}};import{AsyncLocalStorage as Ut}from"node:async_hooks";var R=new Ut;import{env as ke}from"node:process";var ee=()=>!!ke.NETLIFY_DEV||!!ke.NETLIFY_LOCAL;var Ie="__nfSystemLog",O=(e,t)=>{ee()||console.log(Ie,{msg:e,fields:t})},fe=e=>{console.log(Ie,JSON.stringify(e))};var _e=!1,Ee=e=>{let{pcToken:t,pcURL:r,rawUrl:n}=e;return!t||!r?null:{host:new URL(n).hostname,token:t,url:new URL("/.netlify/cache",r).toString()}},Pe=()=>{_e||(_e=!0,globalThis.caches=new be({base64Encode:e=>Ot.from(e,"utf8").toString("base64"),getContext:({operation:e})=>{let t=R.getStore();if(!(t!=null&&t.operationCounter))throw new U("The Cache API must be used within the scope of the request handler. Refer to https://ntl.fyi/cache-api-scope for more information.");let{cacheAPI:r,operationCounter:n}=t,o=e===Q.Delete||e===Q.Write?"cache-api-write":"cache-api-read";return n.register(o)?r||(O("missing Cache API metadata in request"),null):(console.log(`You've exceeded the number of allowed Cache API ${o==="cache-api-write"?"writes":"reads"} for a single invocation. Refer to https://ntl.fyi/cache-api-limits for more information.`),null)},userAgent:"netlify-functions"}))};var Le="x-nf-client-connection-ip",Ae="x-nf-geo",Te="x-nf-account-id",te="x-nf-deploy-id",Ne="x-nf-deploy-context",$e="x-nf-deploy-published",Ue="x-nf-site-id",Oe="x-nf-request-flags",pe="x-nf-invocation-metadata",Fe="x-nf-request-id",De="x-nf-start-timestamp",Ft=255,qe=e=>{let t=new Headers;return Object.entries(e).forEach(([r,n])=>{if(n!==void 0)try{t.set(r.toLowerCase(),n)}catch(o){if([...n].every(i=>i.codePointAt(0)<=Ft))throw o;console.warn(`Discarded request header '${r}' because it contains non-ASCII characters`)}}),t},He=e=>{let t={};for(let[r,n]of e.entries())r in t?t[r].push(n):t[r]=[n];return t};var re=e=>({id:e.headers.get(Te)??""});var ne=e=>({context:e.get(Ne)??"",id:e.get(te)??"",published:e.get($e)==="1"});import{Buffer as Dt}from"buffer";var oe=Symbol("Request flags"),F=Symbol("Request route"),qt=typeof Request>"u"?class{}:Request,Me,se=class extends(Me=qt,oe,F,Me){},je=(e,t)=>{if(!(e==null||e===""))return t?Dt.from(e,"base64"):e};var j=class{#e;#t;constructor(t){this.#e=new Set,this.#t=t}get(t){let r=this.#t[t];return r!==void 0&&this.#e.add(t),r}get evaluations(){return this.#e}},We=e=>e[oe]??new j({}),Be=(e,t)=>{e[oe]=t};import{Buffer as Ht}from"node:buffer";var Ge=e=>{if(e===null)return{};try{let{postal_code:t,...r}=JSON.parse(Ht.from(e,"base64").toString("utf-8"));return Object.fromEntries(Object.entries({...r,postalCode:t}).filter(([,o])=>o!==void 0))}catch{return{}}};var Ve=e=>e??"";var G=class{constructor(e,t,r,n,o,a){this.type=3,this.name="",this.prefix="",this.value="",this.suffix="",this.modifier=3,this.type=e,this.name=t,this.prefix=r,this.value=n,this.suffix=o,this.modifier=a}hasCustomName(){return this.name!==""&&typeof this.name!="number"}},Mt=/[$_\p{ID_Start}]/u,jt=/[$_\u200C\u200D\p{ID_Continue}]/u,me=".*";function Wt(e,t){return(t?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(e)}function Ye(e,t=!1){let r=[],n=0;for(;n<e.length;){let o=e[n],a=function(i){if(!t)throw new TypeError(i);r.push({type:"INVALID_CHAR",index:n,value:e[n++]})};if(o==="*"){r.push({type:"ASTERISK",index:n,value:e[n++]});continue}if(o==="+"||o==="?"){r.push({type:"OTHER_MODIFIER",index:n,value:e[n++]});continue}if(o==="\\"){r.push({type:"ESCAPED_CHAR",index:n++,value:e[n++]});continue}if(o==="{"){r.push({type:"OPEN",index:n,value:e[n++]});continue}if(o==="}"){r.push({type:"CLOSE",index:n,value:e[n++]});continue}if(o===":"){let i="",s=n+1;for(;s<e.length;){let h=e.substr(s,1);if(s===n+1&&Mt.test(h)||s!==n+1&&jt.test(h)){i+=e[s++];continue}break}if(!i){a(`Missing parameter name at ${n}`);continue}r.push({type:"NAME",index:n,value:i}),n=s;continue}if(o==="("){let i=1,s="",h=n+1,c=!1;if(e[h]==="?"){a(`Pattern cannot start with "?" at ${h}`);continue}for(;h<e.length;){if(!Wt(e[h],!1)){a(`Invalid character '${e[h]}' at ${h}.`),c=!0;break}if(e[h]==="\\"){s+=e[h++]+e[h++];continue}if(e[h]===")"){if(i--,i===0){h++;break}}else if(e[h]==="("&&(i++,e[h+1]!=="?")){a(`Capturing groups are not allowed at ${h}`),c=!0;break}s+=e[h++]}if(c)continue;if(i){a(`Unbalanced pattern at ${n}`);continue}if(!s){a(`Missing pattern at ${n}`);continue}r.push({type:"REGEX",index:n,value:s}),n=h;continue}r.push({type:"CHAR",index:n,value:e[n++]})}return r.push({type:"END",index:n,value:""}),r}function Ke(e,t={}){let r=Ye(e);t.delimiter??(t.delimiter="/#?"),t.prefixes??(t.prefixes="./");let n=`[^${S(t.delimiter)}]+?`,o=[],a=0,i=0,s="",h=new Set,c=l=>{if(i<r.length&&r[i].type===l)return r[i++].value},u=()=>c("OTHER_MODIFIER")??c("ASTERISK"),p=l=>{let d=c(l);if(d!==void 0)return d;let{type:m,index:v}=r[i];throw new TypeError(`Unexpected ${m} at ${v}, expected ${l}`)},y=()=>{let l="",d;for(;d=c("CHAR")??c("ESCAPED_CHAR");)l+=d;return l},E=l=>l,P=t.encodePart||E,w="",L=l=>{w+=l},q=()=>{w.length&&(o.push(new G(3,"","",P(w),"",3)),w="")},z=(l,d,m,v,H)=>{let g=3;switch(H){case"?":g=1;break;case"*":g=0;break;case"+":g=2;break}if(!d&&!m&&g===3){L(l);return}if(q(),!d&&!m){if(!l)return;o.push(new G(3,"","",P(l),"",g));return}let f;m?m==="*"?f=me:f=m:f=n;let A=2;f===n?(A=1,f=""):f===me&&(A=0,f="");let k;if(d?k=d:m&&(k=a++),h.has(k))throw new TypeError(`Duplicate name '${k}'.`);h.add(k),o.push(new G(A,k,P(l),f,P(v),g))};for(;i<r.length;){let l=c("CHAR"),d=c("NAME"),m=c("REGEX");if(!d&&!m&&(m=c("ASTERISK")),d||m){let g=l??"";t.prefixes.indexOf(g)===-1&&(L(g),g=""),q();let f=u();z(g,d,m,"",f);continue}let v=l??c("ESCAPED_CHAR");if(v){L(v);continue}if(c("OPEN")){let g=y(),f=c("NAME"),A=c("REGEX");!f&&!A&&(A=c("ASTERISK"));let k=y();p("CLOSE");let vt=u();z(g,f,A,k,vt);continue}q(),p("END")}return o}function S(e){return e.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function ze(e){return e&&e.ignoreCase?"ui":"u"}function Bt(e,t,r){return Xe(Ke(e,r),t,r)}function D(e){switch(e){case 0:return"*";case 1:return"?";case 2:return"+";case 3:return""}}function Xe(e,t,r={}){r.delimiter??(r.delimiter="/#?"),r.prefixes??(r.prefixes="./"),r.sensitive??(r.sensitive=!1),r.strict??(r.strict=!1),r.end??(r.end=!0),r.start??(r.start=!0),r.endsWith="";let n=r.start?"^":"";for(let s of e){if(s.type===3){s.modifier===3?n+=S(s.value):n+=`(?:${S(s.value)})${D(s.modifier)}`;continue}t&&t.push(s.name);let h=`[^${S(r.delimiter)}]+?`,c=s.value;if(s.type===1?c=h:s.type===0&&(c=me),!s.prefix.length&&!s.suffix.length){s.modifier===3||s.modifier===1?n+=`(${c})${D(s.modifier)}`:n+=`((?:${c})${D(s.modifier)})`;continue}if(s.modifier===3||s.modifier===1){n+=`(?:${S(s.prefix)}(${c})${S(s.suffix)})`,n+=D(s.modifier);continue}n+=`(?:${S(s.prefix)}`,n+=`((?:${c})(?:`,n+=S(s.suffix),n+=S(s.prefix),n+=`(?:${c}))*)${S(s.suffix)})`,s.modifier===0&&(n+="?")}let o=`[${S(r.endsWith)}]|$`,a=`[${S(r.delimiter)}]`;if(r.end)return r.strict||(n+=`${a}?`),r.endsWith.length?n+=`(?=${o})`:n+="$",new RegExp(n,ze(r));r.strict||(n+=`(?:${a}(?=${o}))?`);let i=!1;if(e.length){let s=e[e.length-1];s.type===3&&s.modifier===3&&(i=r.delimiter.indexOf(s)>-1)}return i||(n+=`(?=${a}|${o})`),new RegExp(n,ze(r))}var _={delimiter:"",prefixes:"",sensitive:!0,strict:!0},Gt={delimiter:".",prefixes:"",sensitive:!0,strict:!0},Vt={delimiter:"/",prefixes:"/",sensitive:!0,strict:!0};function zt(e,t){return e.length?e[0]==="/"?!0:!t||e.length<2?!1:(e[0]=="\\"||e[0]=="{")&&e[1]=="/":!1}function Qe(e,t){return e.startsWith(t)?e.substring(t.length,e.length):e}function Jt(e,t){return e.endsWith(t)?e.substr(0,e.length-t.length):e}function Ze(e){return!e||e.length<2?!1:e[0]==="["||(e[0]==="\\"||e[0]==="{")&&e[1]==="["}var et=["ftp","file","http","https","ws","wss"];function tt(e){if(!e)return!0;for(let t of et)if(e.test(t))return!0;return!1}function Yt(e,t){if(e=Qe(e,"#"),t||e==="")return e;let r=new URL("https://example.com");return r.hash=e,r.hash?r.hash.substring(1,r.hash.length):""}function Kt(e,t){if(e=Qe(e,"?"),t||e==="")return e;let r=new URL("https://example.com");return r.search=e,r.search?r.search.substring(1,r.search.length):""}function Xt(e,t){return t||e===""?e:Ze(e)?st(e):nt(e)}function Qt(e,t){if(t||e==="")return e;let r=new URL("https://example.com");return r.password=e,r.password}function Zt(e,t){if(t||e==="")return e;let r=new URL("https://example.com");return r.username=e,r.username}function er(e,t,r){if(r||e==="")return e;if(t&&!et.includes(t))return new URL(`${t}:${e}`).pathname;let n=e[0]=="/";return e=new URL(n?e:"/-"+e,"https://example.com").pathname,n||(e=e.substring(2,e.length)),e}function tr(e,t,r){return rt(t)===e&&(e=""),r||e===""?e:ot(e)}function rr(e,t){return e=Jt(e,":"),t||e===""?e:ge(e)}function rt(e){switch(e){case"ws":case"http":return"80";case"wws":case"https":return"443";case"ftp":return"21";default:return""}}function ge(e){if(e==="")return e;if(/^[-+.A-Za-z0-9]*$/.test(e))return e.toLowerCase();throw new TypeError(`Invalid protocol '${e}'.`)}function nr(e){if(e==="")return e;let t=new URL("https://example.com");return t.username=e,t.username}function sr(e){if(e==="")return e;let t=new URL("https://example.com");return t.password=e,t.password}function nt(e){if(e==="")return e;if(/[\t\n\r #%/:<>?@[\]^\\|]/g.test(e))throw new TypeError(`Invalid hostname '${e}'`);let t=new URL("https://example.com");return t.hostname=e,t.hostname}function st(e){if(e==="")return e;if(/[^0-9a-fA-F[\]:]/g.test(e))throw new TypeError(`Invalid IPv6 hostname '${e}'`);return e.toLowerCase()}function ot(e){if(e===""||/^[0-9]*$/.test(e)&&parseInt(e)<=65535)return e;throw new TypeError(`Invalid port '${e}'.`)}function or(e){if(e==="")return e;let t=new URL("https://example.com");return t.pathname=e[0]!=="/"?"/-"+e:e,e[0]!=="/"?t.pathname.substring(2,t.pathname.length):t.pathname}function ir(e){return e===""?e:new URL(`data:${e}`).pathname}function ar(e){if(e==="")return e;let t=new URL("https://example.com");return t.search=e,t.search.substring(1,t.search.length)}function cr(e){if(e==="")return e;let t=new URL("https://example.com");return t.hash=e,t.hash.substring(1,t.hash.length)}var hr=class{constructor(e){this.tokenList=[],this.internalResult={},this.tokenIndex=0,this.tokenIncrement=1,this.componentStart=0,this.state=0,this.groupDepth=0,this.hostnameIPv6BracketDepth=0,this.shouldTreatAsStandardURL=!1,this.input=e}get result(){return this.internalResult}parse(){for(this.tokenList=Ye(this.input,!0);this.tokenIndex<this.tokenList.length;this.tokenIndex+=this.tokenIncrement){if(this.tokenIncrement=1,this.tokenList[this.tokenIndex].type==="END"){if(this.state===0){this.rewind(),this.isHashPrefix()?this.changeState(9,1):this.isSearchPrefix()?(this.changeState(8,1),this.internalResult.hash=""):(this.changeState(7,0),this.internalResult.search="",this.internalResult.hash="");continue}else if(this.state===2){this.rewindAndSetState(5);continue}this.changeState(10,0);break}if(this.groupDepth>0)if(this.isGroupClose())this.groupDepth-=1;else continue;if(this.isGroupOpen()){this.groupDepth+=1;continue}switch(this.state){case 0:this.isProtocolSuffix()&&(this.internalResult.username="",this.internalResult.password="",this.internalResult.hostname="",this.internalResult.port="",this.internalResult.pathname="",this.internalResult.search="",this.internalResult.hash="",this.rewindAndSetState(1));break;case 1:if(this.isProtocolSuffix()){this.computeShouldTreatAsStandardURL();let e=7,t=1;this.shouldTreatAsStandardURL&&(this.internalResult.pathname="/"),this.nextIsAuthoritySlashes()?(e=2,t=3):this.shouldTreatAsStandardURL&&(e=2),this.changeState(e,t)}break;case 2:this.isIdentityTerminator()?this.rewindAndSetState(3):(this.isPathnameStart()||this.isSearchPrefix()||this.isHashPrefix())&&this.rewindAndSetState(5);break;case 3:this.isPasswordPrefix()?this.changeState(4,1):this.isIdentityTerminator()&&this.changeState(5,1);break;case 4:this.isIdentityTerminator()&&this.changeState(5,1);break;case 5:this.isIPv6Open()?this.hostnameIPv6BracketDepth+=1:this.isIPv6Close()&&(this.hostnameIPv6BracketDepth-=1),this.isPortPrefix()&&!this.hostnameIPv6BracketDepth?this.changeState(6,1):this.isPathnameStart()?this.changeState(7,0):this.isSearchPrefix()?this.changeState(8,1):this.isHashPrefix()&&this.changeState(9,1);break;case 6:this.isPathnameStart()?this.changeState(7,0):this.isSearchPrefix()?this.changeState(8,1):this.isHashPrefix()&&this.changeState(9,1);break;case 7:this.isSearchPrefix()?this.changeState(8,1):this.isHashPrefix()&&this.changeState(9,1);break;case 8:this.isHashPrefix()&&this.changeState(9,1);break;case 9:break;case 10:break}}}changeState(e,t){switch(this.state){case 0:break;case 1:this.internalResult.protocol=this.makeComponentString();break;case 2:break;case 3:this.internalResult.username=this.makeComponentString();break;case 4:this.internalResult.password=this.makeComponentString();break;case 5:this.internalResult.hostname=this.makeComponentString();break;case 6:this.internalResult.port=this.makeComponentString();break;case 7:this.internalResult.pathname=this.makeComponentString();break;case 8:this.internalResult.search=this.makeComponentString();break;case 9:this.internalResult.hash=this.makeComponentString();break;case 10:break}this.changeStateWithoutSettingComponent(e,t)}changeStateWithoutSettingComponent(e,t){this.state=e,this.componentStart=this.tokenIndex+t,this.tokenIndex+=t,this.tokenIncrement=0}rewind(){this.tokenIndex=this.componentStart,this.tokenIncrement=0}rewindAndSetState(e){this.rewind(),this.state=e}safeToken(e){return e<0&&(e=this.tokenList.length-e),e<this.tokenList.length?this.tokenList[e]:this.tokenList[this.tokenList.length-1]}isNonSpecialPatternChar(e,t){let r=this.safeToken(e);return r.value===t&&(r.type==="CHAR"||r.type==="ESCAPED_CHAR"||r.type==="INVALID_CHAR")}isProtocolSuffix(){return this.isNonSpecialPatternChar(this.tokenIndex,":")}nextIsAuthoritySlashes(){return this.isNonSpecialPatternChar(this.tokenIndex+1,"/")&&this.isNonSpecialPatternChar(this.tokenIndex+2,"/")}isIdentityTerminator(){return this.isNonSpecialPatternChar(this.tokenIndex,"@")}isPasswordPrefix(){return this.isNonSpecialPatternChar(this.tokenIndex,":")}isPortPrefix(){return this.isNonSpecialPatternChar(this.tokenIndex,":")}isPathnameStart(){return this.isNonSpecialPatternChar(this.tokenIndex,"/")}isSearchPrefix(){if(this.isNonSpecialPatternChar(this.tokenIndex,"?"))return!0;if(this.tokenList[this.tokenIndex].value!=="?")return!1;let e=this.safeToken(this.tokenIndex-1);return e.type!=="NAME"&&e.type!=="REGEX"&&e.type!=="CLOSE"&&e.type!=="ASTERISK"}isHashPrefix(){return this.isNonSpecialPatternChar(this.tokenIndex,"#")}isGroupOpen(){return this.tokenList[this.tokenIndex].type=="OPEN"}isGroupClose(){return this.tokenList[this.tokenIndex].type=="CLOSE"}isIPv6Open(){return this.isNonSpecialPatternChar(this.tokenIndex,"[")}isIPv6Close(){return this.isNonSpecialPatternChar(this.tokenIndex,"]")}makeComponentString(){let e=this.tokenList[this.tokenIndex],t=this.safeToken(this.componentStart).index;return this.input.substring(t,e.index)}computeShouldTreatAsStandardURL(){let e={};Object.assign(e,_),e.encodePart=ge;let t=Bt(this.makeComponentString(),void 0,e);this.shouldTreatAsStandardURL=tt(t)}},de=["protocol","username","password","hostname","port","pathname","search","hash"],I="*";function Je(e,t){if(typeof e!="string")throw new TypeError("parameter 1 is not of type 'string'.");let r=new URL(e,t);return{protocol:r.protocol.substring(0,r.protocol.length-1),username:r.username,password:r.password,hostname:r.hostname,port:r.port,pathname:r.pathname,search:r.search!==""?r.search.substring(1,r.search.length):void 0,hash:r.hash!==""?r.hash.substring(1,r.hash.length):void 0}}function b(e,t){return t?B(e):e}function W(e,t,r){let n;if(typeof t.baseURL=="string")try{n=new URL(t.baseURL),e.protocol=b(n.protocol.substring(0,n.protocol.length-1),r),e.username=b(n.username,r),e.password=b(n.password,r),e.hostname=b(n.hostname,r),e.port=b(n.port,r),e.pathname=b(n.pathname,r),e.search=b(n.search.substring(1,n.search.length),r),e.hash=b(n.hash.substring(1,n.hash.length),r)}catch{throw new TypeError(`invalid baseURL '${t.baseURL}'.`)}if(typeof t.protocol=="string"&&(e.protocol=rr(t.protocol,r)),typeof t.username=="string"&&(e.username=Zt(t.username,r)),typeof t.password=="string"&&(e.password=Qt(t.password,r)),typeof t.hostname=="string"&&(e.hostname=Xt(t.hostname,r)),typeof t.port=="string"&&(e.port=tr(t.port,e.protocol,r)),typeof t.pathname=="string"){if(e.pathname=t.pathname,n&&!zt(e.pathname,r)){let o=n.pathname.lastIndexOf("/");o>=0&&(e.pathname=b(n.pathname.substring(0,o+1),r)+e.pathname)}e.pathname=er(e.pathname,e.protocol,r)}return typeof t.search=="string"&&(e.search=Kt(t.search,r)),typeof t.hash=="string"&&(e.hash=Yt(t.hash,r)),e}function B(e){return e.replace(/([+*?:{}()\\])/g,"\\$1")}function ur(e){return e.replace(/([.+*?^${}()[\]|/\\])/g,"\\$1")}function lr(e,t){t.delimiter??(t.delimiter="/#?"),t.prefixes??(t.prefixes="./"),t.sensitive??(t.sensitive=!1),t.strict??(t.strict=!1),t.end??(t.end=!0),t.start??(t.start=!0),t.endsWith="";let r=".*",n=`[^${ur(t.delimiter)}]+?`,o=/[$_\u200C\u200D\p{ID_Continue}]/u,a="";for(let i=0;i<e.length;++i){let s=e[i];if(s.type===3){if(s.modifier===3){a+=B(s.value);continue}a+=`{${B(s.value)}}${D(s.modifier)}`;continue}let h=s.hasCustomName(),c=!!s.suffix.length||!!s.prefix.length&&(s.prefix.length!==1||!t.prefixes.includes(s.prefix)),u=i>0?e[i-1]:null,p=i<e.length-1?e[i+1]:null;if(!c&&h&&s.type===1&&s.modifier===3&&p&&!p.prefix.length&&!p.suffix.length)if(p.type===3){let y=p.value.length>0?p.value[0]:"";c=o.test(y)}else c=!p.hasCustomName();if(!c&&!s.prefix.length&&u&&u.type===3){let y=u.value[u.value.length-1];c=t.prefixes.includes(y)}c&&(a+="{"),a+=B(s.prefix),h&&(a+=`:${s.name}`),s.type===2?a+=`(${s.value})`:s.type===1?h||(a+=`(${n})`):s.type===0&&(!h&&(!u||u.type===3||u.modifier!==3||c||s.prefix!=="")?a+="*":a+=`(${r})`),s.type===1&&h&&s.suffix.length&&o.test(s.suffix[0])&&(a+="\\"),a+=B(s.suffix),c&&(a+="}"),s.modifier!==3&&(a+=D(s.modifier))}return a}var ie=class{constructor(e={},t,r){this.regexp={},this.names={},this.component_pattern={},this.parts={};try{let n;if(typeof t=="string"?n=t:r=t,typeof e=="string"){let s=new hr(e);if(s.parse(),e=s.result,n===void 0&&typeof e.protocol!="string")throw new TypeError("A base URL must be provided for a relative constructor string.");e.baseURL=n}else{if(!e||typeof e!="object")throw new TypeError("parameter 1 is not of type 'string' and cannot convert to dictionary.");if(n)throw new TypeError("parameter 1 is not of type 'string'.")}typeof r>"u"&&(r={ignoreCase:!1});let o={ignoreCase:r.ignoreCase===!0},a={pathname:I,protocol:I,username:I,password:I,hostname:I,port:I,search:I,hash:I};this.pattern=W(a,e,!0),rt(this.pattern.protocol)===this.pattern.port&&(this.pattern.port="");let i;for(i of de){if(!(i in this.pattern))continue;let s={},h=this.pattern[i];switch(this.names[i]=[],i){case"protocol":Object.assign(s,_),s.encodePart=ge;break;case"username":Object.assign(s,_),s.encodePart=nr;break;case"password":Object.assign(s,_),s.encodePart=sr;break;case"hostname":Object.assign(s,Gt),Ze(h)?s.encodePart=st:s.encodePart=nt;break;case"port":Object.assign(s,_),s.encodePart=ot;break;case"pathname":tt(this.regexp.protocol)?(Object.assign(s,Vt,o),s.encodePart=or):(Object.assign(s,_,o),s.encodePart=ir);break;case"search":Object.assign(s,_,o),s.encodePart=ar;break;case"hash":Object.assign(s,_,o),s.encodePart=cr;break}try{this.parts[i]=Ke(h,s),this.regexp[i]=Xe(this.parts[i],this.names[i],s),this.component_pattern[i]=lr(this.parts[i],s)}catch{throw new TypeError(`invalid ${i} pattern '${this.pattern[i]}'.`)}}}catch(n){throw new TypeError(`Failed to construct 'URLPattern': ${n.message}`)}}test(e={},t){let r={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof e!="string"&&t)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof e>"u")return!1;try{typeof e=="object"?r=W(r,e,!1):r=W(r,Je(e,t),!1)}catch{return!1}let n;for(n of de)if(!this.regexp[n].exec(r[n]))return!1;return!0}exec(e={},t){let r={pathname:"",protocol:"",username:"",password:"",hostname:"",port:"",search:"",hash:""};if(typeof e!="string"&&t)throw new TypeError("parameter 1 is not of type 'string'.");if(typeof e>"u")return;try{typeof e=="object"?r=W(r,e,!1):r=W(r,Je(e,t),!1)}catch{return null}let n={};t?n.inputs=[e,t]:n.inputs=[e];let o;for(o of de){let a=this.regexp[o].exec(r[o]);if(!a)return null;let i={};for(let[s,h]of this.names[o].entries())if(typeof h=="string"||typeof h=="number"){let c=a[s+1];i[h]=c}n[o]={input:r[o]??"",groups:i}}return n}static compareComponent(e,t,r){let n=(s,h)=>{for(let c of["type","modifier","prefix","value","suffix"]){if(s[c]<h[c])return-1;if(s[c]===h[c])continue;return 1}return 0},o=new G(3,"","","","",3),a=new G(0,"","","","",3),i=(s,h)=>{let c=0;for(;c<Math.min(s.length,h.length);++c){let u=n(s[c],h[c]);if(u)return u}return s.length===h.length?0:n(s[c]??o,h[c]??o)};return!t.component_pattern[e]&&!r.component_pattern[e]?0:t.component_pattern[e]&&!r.component_pattern[e]?i(t.parts[e],[a]):!t.component_pattern[e]&&r.component_pattern[e]?i([a],r.parts[e]):i(t.parts[e],r.parts[e])}get protocol(){return this.component_pattern.protocol}get username(){return this.component_pattern.username}get password(){return this.component_pattern.password}get hostname(){return this.component_pattern.hostname}get port(){return this.component_pattern.port}get pathname(){return this.component_pattern.pathname}get search(){return this.component_pattern.search}get hash(){return this.component_pattern.hash}};globalThis.URLPattern||(globalThis.URLPattern=ie);var it=(e,t)=>{var i;if(e===void 0)return{};let r=t.endsWith("/")?t.slice(0,-1):t,o=(i=new ie({pathname:e,baseURL:r}).exec(r))==null?void 0:i.pathname.groups;return o?Object.entries(o).reduce((s,[h,c])=>c===void 0?s:{...s,[h]:c},{}):{}};var ae=e=>e.headers.get(Fe)||"";import{env as fr}from"process";var at=()=>({region:fr.AWS_REGION});import{env as xe}from"process";var ct=()=>({id:xe.SITE_ID,name:xe.SITE_NAME,url:xe.URL});var pr=e=>{let t=JSON.stringify(e);return new Response(t,{headers:{"content-type":"application/json"}})},ht=(e,t)=>{let r={};try{r=it(e[F],e.url)}catch{console.log(`Could not parse function route ${e[F]}.`)}let n={enqueuedPromises:[]};return{context:{account:re(e),cookies:t.getPublicInterface(),deploy:ne(e.headers),flags:We(e),geo:Ge(e.headers.get(Ae)),ip:Ve(e.headers.get(Le)),json:pr,log:console.log,next:()=>{throw new Error("`context.next` is not implemented for serverless functions")},params:r,requestId:ae(e),rewrite:a=>{let i=dr(a,e.url);return mr(i)},server:at(),site:ct(),url:new URL(e.url),waitUntil:function(i){if(arguments.length===0)throw new TypeError("waitUntil: At least 1 argument required, but only 0 passed");n.enqueuedPromises.push(Promise.resolve(i).catch(s=>console.error(s)))}},state:n}},dr=(e,t)=>{if(e instanceof URL)return e;if(e.startsWith("/")){let r=new URL(t);return r.pathname=e,r}return new URL(e)},mr=async e=>await fetch(e);import lt from"node:assert";function ut(e){function t(c,u=2){return c.padStart(u,"0")}let r=t(e.getUTCDate().toString()),n=t(e.getUTCHours().toString()),o=t(e.getUTCMinutes().toString()),a=t(e.getUTCSeconds().toString()),i=e.getUTCFullYear(),s=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return`${s[e.getUTCDay()]}, ${r} ${h[e.getUTCMonth()]} ${i} ${n}:${o}:${a} GMT`}var gr=/^(?=[\u0020-\u007E]*$)[^()@<>,;:\\"[\]?={}\s]+$/;function xr(e){if(!e.name)return"";let t=[];if(yr(e.name),Sr(e.name,e.value),t.push(`${e.name}=${e.value}`),e.name.startsWith("__Secure")&&(e.secure=!0),e.name.startsWith("__Host")&&(e.path="/",e.secure=!0,delete e.domain),e.secure&&t.push("Secure"),e.httpOnly&&t.push("HttpOnly"),typeof e.maxAge=="number"&&Number.isInteger(e.maxAge)&&(lt(e.maxAge>=0,"Max-Age must be an integer superior or equal to 0"),t.push(`Max-Age=${e.maxAge}`)),e.domain&&(Rr(e.domain),t.push(`Domain=${e.domain}`)),e.sameSite&&t.push(`SameSite=${e.sameSite}`),e.path&&(wr(e.path),t.push(`Path=${e.path}`)),e.expires){let{expires:r}=e,n=ut(typeof r=="number"?new Date(r):r);t.push(`Expires=${n}`)}return e.unparsed&&t.push(e.unparsed.join("; ")),t.join("; ")}function yr(e){if(e&&!gr.test(e))throw new TypeError(`Invalid cookie name: "${e}".`)}function wr(e){if(e!=null)for(let t=0;t<e.length;t++){let r=e.charAt(t);if(r<" "||r>"~"||r==";")throw new Error(`${e}: Invalid cookie path char '${r}'`)}}function Sr(e,t){if(!(t==null||e==null))for(let r=0;r<t.length;r++){let n=t.charAt(r);if(n<"!"||n=='"'||n==","||n==";"||n=="\\"||n=="\x7F")throw new Error(`RFC2616 cookie '${e}' cannot contain character '${n}'`);if(n>"\x80")throw new Error(`RFC2616 cookie '${e}' can only have US-ASCII chars as value${n.charCodeAt(0).toString(16)}`)}}function Rr(e){if(e==null)return;let t=e.charAt(0),r=e.charAt(e.length-1);if(t=="-"||r=="."||r=="-")throw new Error(`Invalid first/last char in cookie domain: ${e}`)}function ft(e){let t=e.get("Cookie");if(t!=null){let r={},n=t.split(";");for(let o of n){let[a,...i]=o.split("=");lt(a!=null);let s=a.trim();r[s]=i.join("=")}return r}return{}}function ye(e,t){let r=xr(t);r&&e.append("Set-Cookie",r)}function pt(e,t,r){ye(e,Object.assign({name:t,value:"",expires:new Date(0)},r))}var ce=class{constructor(t){this.ops=[],this.request=t}apply(t){this.ops.forEach(r=>{switch(r.type){case"delete":pt(t,r.options.name,{domain:r.options.domain,path:r.options.path});break;case"set":ye(t,r.cookie);break;default:}})}delete(t){let r={path:"/"},n=typeof t=="string"?{name:t}:t;this.ops.push({options:{...r,...n},type:"delete"})}get(t){return ft(this.request.headers)[t]}getPublicInterface(){return{delete:this.delete.bind(this),get:this.get.bind(this),set:this.set.bind(this)}}set(t,r){let n;if(typeof t=="string"){if(typeof r!="string")throw new TypeError("You must provide the cookie value as a string to 'cookies.set'");n={name:t,value:r}}else n=t;this.ops.push({cookie:n,type:"set"})}};import{Buffer as dt}from"node:buffer";import we from"node:process";var Cr="NETLIFY_PURGE_API_TOKEN",vr="NETLIFY_BRANCH",br="NETLIFY_BLOBS_CONTEXT",he=e=>typeof e=="string"&&e.length!==0,mt=(e,t,r,n)=>{var h,c;let{blobs:o,pcToken:a,pcURL:i}=t,s=(c=(h=r==null?void 0:r.clientContext)==null?void 0:h.custom)==null?void 0:c.purge_api_token;if(typeof o=="string"&&o!=="")try{let u=dt.from(o,"base64").toString("utf8"),p=JSON.parse(u),y=e.get(Ue),E=e.get(te);we.env[br]=dt.from(JSON.stringify({edgeURL:p.url,uncachedEdgeURL:p.url_uncached,token:p.token,siteID:y,deployID:E,primaryRegion:p.primary_region})).toString("base64")}catch(u){console.error("An internal error occurred while setting up Netlify Blobs:",u)}he(s)&&(we.env[Cr]=s),he(a)&&he(i)&&Pe(),n&&he(n.branch)&&(we.env[vr]=n.branch)};import kr from"node:http";import Ir from"node:https";var _r=globalThis.fetch,gt=!1,xt=e=>{let t=R.getStore();if(t!=null&&t.cdnLoopHeader){if(e.headersSent){O("Headers already sent, cannot add CDN-Loop header");return}e.setHeader("CDN-Loop",t==null?void 0:t.cdnLoopHeader)}},yt=()=>{if(!gt){gt=!0,globalThis.fetch=function(t,r){let n=new Request(t,r),o=R.getStore();return o!=null&&o.cdnLoopHeader&&n.headers.set("CDN-Loop",o.cdnLoopHeader),_r(n)};for(let e of[kr,Ir]){let t=e.request;e.get=function(...n){let o=t(...n);return xt(o),o.end(),o},e.request=function(...n){let o=t(...n);return xt(o),o}}}};var wt=({awsRequestID:e,req:t,branch:r,functionName:n,logToken:o})=>{let a=new URL(t.url),i=ae(t),s={aws_req_id:e,aid:re(t).id,branch:r??"",did:ne(t.headers).id,fn:n??"",host:a.host,log_token:o,method:t.method,nf_req_id:i,ts:Date.now(),path:a.pathname};fe({fields:s,type:"bootstrap/request"})},Se=({awsRequestID:e,result:t})=>{let r={aws_req_id:e};t instanceof Response?r.status=t.status:t instanceof Error?r.error_message=t.message:r.status=204,fe({fields:r,type:"bootstrap/response"})};var St=!1,Er=e=>(...t)=>{let[r,n]=t;if(typeof r=="string"&&r.startsWith("/"))try{let o=R.getStore(),a=o==null?void 0:o.context.url;if(!a)throw new Error("Could not find request in context");let i=new URL(r,a);return e(i,n)}catch{O("An error occurred in the patched Response.redirect")}return e(...t)},Rt=()=>{St||(St=!0,"Response"in globalThis&&Response.redirect&&(Response.redirect=Er(Response.redirect)))};var $r=Nr(Ar),Ur=20,Or=e=>awslambda.streamifyResponse(async(t,r,n)=>{let o=Date.now(),a=n.awsRequestId,{body:i,flags:s,headers:h,httpMethod:c,invocationMetadata:u,isBase64Encoded:p,logToken:y,rawUrl:E,route:P}=t,w=new j(s||{}),L=qe(h),q=je(i,p),z=w.get("serverless_functions_abort_signal")===!0?AbortSignal.timeout(n.getRemainingTimeInMillis()-Ur):void 0,l=new se(E,{body:q,headers:L,method:c,signal:z}),d=!ee()&&w.get("serverless_functions_log_metadata")===!0;w.get("serverless_functions_response_redirect_relative")===!0&&Rt(),d&&wt({awsRequestID:a,branch:u==null?void 0:u.branch,functionName:u==null?void 0:u.function_name,logToken:y,req:l}),mt(L,t,n,u),Be(l,w),P&&(l[F]=P),w.get("serverless_functions_request_interceptor_v2")===!0&&yt(),w.get("serverless_functions_wait_event_loop")===!0&&(n.callbackWaitsForEmptyEventLoop=!1);let m=new ce(l),{context:v,state:H}=ht(l,m),g={cacheAPI:Ee(t),cdnLoopHeader:L.get("cdn-loop"),context:v,operationCounter:new Z};try{let f=await R.run(g,()=>e.default(l,v));d&&Se({awsRequestID:a,result:f}),await Fr(f,r,m,w,o)}catch(f){throw d&&Se({awsRequestID:a,result:f}),f}if(H.enqueuedPromises.length!==0)try{await Promise.allSettled(H.enqueuedPromises)}catch(f){console.error(f)}}),Fr=async(e,t,r,n,o)=>{let a={version:Lr.version},i=Pr.from(JSON.stringify(a)).toString("base64");if(e instanceof Response){let s=new Headers(e.headers);r.apply(s);let{body:h,status:c}=e,u=n.evaluations;u.size!==0&&s.set(Oe,[...u].join(",")),s.set(pe,i),s.set(De,o.toString());let p={multiValueHeaders:He(s),statusCode:c},y=awslambda.HttpResponseStream.from(t,p);if((n.get("serverless_functions_fix_empty_body")===!0||h===null)&&y.write(""),h===null){y.end();return}let E=Tr.fromWeb(h);await $r(E,y);return}if(e===void 0){let s=awslambda.HttpResponseStream.from(t,{statusCode:204,headers:{[pe]:i}});s.write(""),s.end();return}throw new U("Function returned an unsupported value. Accepted types are 'Response' or 'undefined'")};import V from"process";var Dr={delete:e=>{delete V.env[e]},get:e=>V.env[e],has:e=>!!V.env[e],set:(e,t)=>{V.env[e]=t},toObject:()=>Object.entries(V.env).reduce((e,[t,r])=>r===void 0?e:{...e,[t]:r},{})},Ct={get context(){let e=R.getStore();return(e==null?void 0:e.context)??null},env:Dr};globalThis.Netlify=Ct;var qr=()=>Ct;var Vs=()=>Hr(import.meta.url);export{Or as getLambdaHandler,qr as getNetlifyGlobal,Vs as getPath};
